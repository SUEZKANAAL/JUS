<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Project Overview</title>
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <link rel="stylesheet" href="../styles/projecten-overview.css" />
    <link href="../css/styles.css" rel="stylesheet" />
    <style>
      /* Extra CSS for project cards */
      .project-card {
        margin-bottom: 20px;
      }
      .project-card .card-body {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }
      .project-header {
        font-weight: bold;
      }
      .project-section {
        margin-top: 40px;
      }
    </style>
  </head>
  <body>
    <!-- only show page if logged in -->
    <script>
      const token = localStorage.getItem("accessToken");
      if (!token) {
        window.location.replace("./login.html");
      }
    </script>

    <!-- Navigation -->
         <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">
        <h1 class="navbar-brand"><a href="../">Sue</a></h1>
        <!-- <a class="navbar-brand" href="/"><img src="" alt="..." /></a> -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarResponsive"
          aria-controls="navbarResponsive"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          Menu
          <i class="fas fa-bars ms-1"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ms-auto py-4 py-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="/pages/intekenen.html">Intekenen</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/pages/viewer.html">Viewer</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/pages/projecten-overview.html">Porjecten</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/#services">Diensten</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/#portfolio">Tools</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/#about">Proces</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/#instructie">Instructie</a>
            </li>
            <li class="nav-item" id="navLogin">
              <a class="nav-link" href="/pages/login.html">Login</a>
            </li>
            <li class="nav-item" id="navLogout">
              <a class="nav-link" href="#" id="logoutBtn">Logout</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>


    <!-- Page header -->
    <header class="masthead">
      <div class="container text-center">
        <h1 class="masthead-heading text-uppercase">Projecten</h1>
      </div>
    </header>

    <!-- filter projects bar -->
    <div
      id="projectFilters"
      class="container mt-4"
      style="margin-bottom: 20px; display: none; gap: 10px; flex-wrap: wrap"
    >
      <input
        id="searchInput"
        type="text"
        placeholder="Zoek projecten..."
        style="
          padding: 8px;
          border-radius: 6px;
          border: 1px solid #ccc;
          flex: 1;
          min-width: 200px;
        "
      />

      <select
        id="sortSelect"
        style="padding: 8px; border-radius: 6px; border: 1px solid #ccc"
      >
        <option value="nameAsc">Naam (A → Z)</option>
        <option value="nameDesc">Naam (Z → A)</option>
        <option value="dateNewest">Nieuwste eerst</option>
        <option value="dateOldest">Oudste eerst</option>
      </select>

      <input
        id="dateFrom"
        type="date"
        style="padding: 8px; border-radius: 6px; border: 1px solid #ccc"
      />

      <input
        id="dateTo"
        type="date"
        style="padding: 8px; border-radius: 6px; border: 1px solid #ccc"
      />
    </div>

    <section class="container project-section" id="projectsContainer">
      <!-- Cards will be inserted dynamically -->
    </section>

    <!-- Modal for uploading multiple traces -->
    <div
      id="traceModal"
      class="modal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      "
    >
      <div
        class="modal-content"
        style="
          background: white;
          padding: 20px;
          border-radius: 8px;
          width: 500px;
          position: relative;
          max-height: 80vh;
          overflow-y: auto;
        "
      >
        <span
          id="closeModal"
          style="
            position: absolute;
            top: 10px;
            right: 15px;
            cursor: pointer;
            font-weight: bold;
          "
          >&times;</span
        >
        <h4>Upload Traces</h4>
        <!-- Project name display -->
        <p
          id="traceModalProjectName"
          style="font-weight: bold; margin-bottom: 15px"
        >
          Project: Onbekend
        </p>

        <div id="traceEntriesContainer"></div>

        <button id="addTraceEntryBtn" class="btn btn-primary mb-4">
          Voeg een trace toe
        </button>
        <button id="uploadAllBtn" class="btn btn-secondary mb-3">
          Upload Alle Traces
        </button>

        <p id="uploadStatus" style="color: red"></p>
      </div>
    </div>

    <!-- Modal for downloading traces -->
    <div
      id="downloadModal"
      class="modal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      "
    >
      <div
        class="modal-content"
        style="
          background: white;
          padding: 20px;
          border-radius: 8px;
          width: 400px;
          position: relative;
          max-height: 80vh;
          overflow-y: auto;
        "
      >
        <span
          id="closeDownloadModal"
          style="
            position: absolute;
            top: 10px;
            right: 15px;
            cursor: pointer;
            font-weight: bold;
          "
          >&times;</span
        >
        <h4>Download Traces</h4>
        <p
          id="downloadModalProjectName"
          style="font-weight: bold; margin-bottom: 15px"
        >
          Project: Onbekend
        </p>
        <div id="downloadTraceList"></div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="../js/scripts.js"></script>

    <!-- Leaflet core -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Proj4 (needed for RD / EPSG:28992) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.js"></script>

    <!-- Proj4Leaflet (to use custom CRS in Leaflet) -->
    <script src="https://unpkg.com/proj4leaflet@1.0.2/src/proj4leaflet.js"></script>

    <!-- Wicket (for WKT parsing) -->
    <script src="https://cdn.jsdelivr.net/npm/wicket@1.3.5/wicket.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/wicket-leaflet@1.0.0/wicket-leaflet.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Your custom script -->
    <script src="../scripts/project-overview.js"></script>
  </body>
</html>
