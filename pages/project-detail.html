<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Project Detail</title>
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../styles/project-detail.css" />
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" />
    <link href="../css/styles.css" rel="stylesheet" />
  </head>

  <body>
    <!-- only show page if logged in -->
    <script>
      const token = localStorage.getItem("accessToken");
      if (!token) {
        window.location.replace("./login.html");
      }
    </script>

    <!-- Navigation -->
    <div id="app-navbar"></div>
    <script type="module" src="../scripts/layout/bootstrapLayout.js"></script>

    <!-- Page header -->
    <header class="masthead">
      <div class="container text-center">
        <h1 class="masthead-heading text-uppercase" id="projectNameHeader">Project</h1>
        <button id="backToOverviewBtn" class="btn btn-outline-light btn-lg mt-3">
          ‚Üê Terug naar Overzicht
        </button>
      </div>
    </header>

    <!-- Loading Overlay -->
    <div id="loadingSpinnerWrapper">
      <div class="spinner-box">
        <div class="spinner-border text-primary" role="status"></div>
        <p class="mt-3">Project aan het laden...</p>
      </div>
    </div>

    <!-- Project Information Section -->
    <section class="container mt-5" id="projectInfoSection" style="display: none;">
      <div class="row">
        <div class="col-md-12">
          <div class="card mb-4">
            <div class="card-body">
              <h5 class="card-title">Project Informatie</h5>
              <div class="row">
                <div class="col-md-6">
                  <p><strong>Projectnaam:</strong> <span id="projectNameInfo"></span></p>
                  <p><strong>Aangemaakt op:</strong> <span id="projectCreatedAt"></span></p>
                  <p><strong>Rol:</strong> <span id="projectRole"></span></p>
                </div>
                <div class="col-md-6">
                  <p><strong>Aantal Leden:</strong> <span id="projectMemberCount">...</span></p>
                  <p><strong>Aantal Traces:</strong> <span id="projectTraceCount">...</span></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="row mb-4">
        <div class="col-md-12">
          <div class="d-flex flex-wrap gap-2">
            <button class="btn btn-primary view-members-btn">
              Bekijk Leden
            </button>
            <button class="btn btn-primary add-member-btn">
              Voeg Lid Toe
            </button>
            <button class="btn btn-primary create-trace-btn" id="uploadTraceBtn">
              Upload Trace
            </button>
            <button class="btn btn-primary create-feature-btn" id="uploadFeatureBtn">
              Upload Features
            </button>
            <button class="btn btn-primary download-trace-btn" id="downloadTracesBtn">
              Download Traces
            </button>
            <button class="btn btn-success view-project-btn" id="viewProjectBtn">
              Bekijk Project
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Error Message -->
    <section class="container mt-5" id="errorSection" style="display: none;">
      <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading">Fout bij het laden van project</h4>
        <p id="errorMessage"></p>
      </div>
    </section>

    <!-- Modal for uploading multiple traces -->
    <div
      id="traceModal"
      class="modal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      "
    >
      <div
        class="modal-content"
        style="
          background: white;
          padding: 20px;
          border-radius: 8px;
          width: 500px;
          position: relative;
          max-height: 80vh;
          overflow-y: auto;
        "
      >
        <span
          id="closeModal"
          style="
            position: absolute;
            top: 10px;
            right: 15px;
            cursor: pointer;
            font-weight: bold;
          "
          >&times;</span
        >
        <h4>Upload Traces</h4>
        <!-- Project name display -->
        <p
          id="traceModalProjectName"
          style="font-weight: bold; margin-bottom: 15px"
        >
          Project: Onbekend
        </p>

        <div id="traceEntriesContainer"></div>

        <button id="addTraceEntryBtn" class="btn btn-primary mb-4">
          Voeg een trace toe
        </button>
        <button id="uploadAllBtn" class="btn btn-secondary mb-3">
          Upload Alle Traces
        </button>

        <p id="uploadStatus" style="color: red"></p>
      </div>
    </div>

    <!-- Modal for uploading multiple features -->
    <div
      id="featureModal"
      class="modal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      "
    >
      <div
        class="modal-content"
        style="
          background: white;
          padding: 20px;
          border-radius: 8px;
          width: 500px;
          position: relative;
          max-height: 80vh;
          overflow-y: auto;
        "
      >
        <span
          id="closeFeatureModal"
          style="
            position: absolute;
            top: 10px;
            right: 15px;
            cursor: pointer;
            font-weight: bold;
          "
          >&times;</span
        >
        <h4>Upload Features</h4>
        <p
          id="featureModalProjectName"
          style="font-weight: bold; margin-bottom: 15px"
        >
          Project: Onbekend
        </p>

        <div id="featureEntriesContainer"></div>

        <button id="addFeatureEntryBtn" class="btn btn-primary mb-4">
          Voeg een feature toe
        </button>
        <button id="uploadAllFeaturesBtn" class="btn btn-secondary mb-3">
          Upload Alle Features
        </button>

        <p id="featureUploadStatus" style="color: red"></p>
      </div>
    </div>

    <!-- Modal for downloading traces -->
    <div
      id="downloadModal"
      class="modal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      "
    >
      <div
        class="modal-content"
        style="
          background: white;
          padding: 20px;
          border-radius: 8px;
          width: 400px;
          position: relative;
          max-height: 80vh;
          overflow-y: auto;
        "
      >
        <span
          id="closeDownloadModal"
          style="
            position: absolute;
            top: 10px;
            right: 15px;
            cursor: pointer;
            font-weight: bold;
          "
          >&times;</span
        >
        <h4>Download Traces</h4>
        <p
          id="downloadModalProjectName"
          style="font-weight: bold; margin-bottom: 15px"
        >
          Project: Onbekend
        </p>
        <div id="downloadTraceList"></div>
      </div>
    </div>

    <!-- Members Modal -->
    <div
      class="modal fade"
      id="membersModal"
      tabindex="-1"
      aria-labelledby="membersModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="membersModalLabel">Project Leden</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <ul id="membersList" class="list-group"></ul>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Member Modal -->
    <div class="modal fade" id="addMemberModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Voeg lid toe</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <input
              type="text"
              id="newMemberUsername"
              class="form-control"
              placeholder="Username"
            />
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Sluit
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="confirmAddMemberBtn"
            >
              Voeg toe
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="../js/scripts.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Project Detail Scripts -->
    <script type="module" src="../scripts/project-detail/index.js"></script>
  </body>
</html>
